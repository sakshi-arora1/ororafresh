var e=require("penpal"),t=require("@aem-sites/universal-editor-overlays"),r=require("zustand/middleware"),o=require("zustand/vanilla"),s=require("@aem-sites/universal-editor-commons");function n(e,t,r,o){Object.defineProperty(e,t,{get:r,set:o,enumerable:!0,configurable:!0})}n(module.exports,"getEditorContext",(()=>p)),n(module.exports,"registerEditorModeCallback",(()=>g));const i=e=>e.split("/").pop()||"",l=e=>{const[t="",r=""]=e.split("/");return`${r.toUpperCase()} ${t}`},a=e=>{const{naturalWidth:t,naturalHeight:r}=e;return t&&r&&`${t} x ${r}`||""},c=e=>{const t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(0))} ${["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}`},u=Object.freeze({edit:"adobe-ue-edit",preview:"adobe-ue-preview"}),d=({set:e},{mode:t})=>{e((e=>{const r=t===s.REMOTE_APP_MODES.EDIT||t===s.REMOTE_APP_MODES.PREVIEW;return{...e,mode:t,isInEditor:r}}))},m=((E=o)&&E.__esModule?E.default:E)((0,r.subscribeWithSelector)(((e,t)=>({mode:null,isInEditor:!1,setMode:d.bind(null,{get:t,set:e})}))));var E;const p=({isInEditor:e})=>{e&&(e(m.getState().isInEditor),m.subscribe(((t,r)=>{t.isInEditor!==r.isInEditor&&e(t.isInEditor)})))},b=({selector:e,classNames:t,operation:r="toggle"})=>{const o=document.querySelector(e);if(o)for(const e of t)o.classList[r](e)},g=e=>{m.subscribe((e=>[e.mode]),(([t],[r])=>{t!==r&&e(t)}))},y=new RegExp(`^${s.Constants.URN_PREFIX}|^${s.Constants.DEPRECATED_URN_PREFIX}`),f={updateAppMode:e=>{if(!e)return;const{mode:t,setMode:r}=m.getState();if(t){if(t===e)return;b({selector:"html",classNames:Object.values(u)})}else b({selector:"html",classNames:[u[e]]});r({mode:e})},getEditableElement:e=>{const r=document.querySelector(e);return r&&r instanceof HTMLElement?(0,t.getEditableContent)(r):void 0},updateField:async({selector:e,value:t})=>{const r=document.querySelector(e);return r&&(r.innerHTML=t),!0},removeField:({selector:e})=>{const t=document.querySelector(e);t&&t.remove()},getUrnMappings:()=>{const e=document.querySelectorAll(s.Constants.META_SELECTOR);return Array.from(e).reduce(((e,{name:t,content:r})=>({...e,[t.replace(y,"")]:r})),{})},getMediaProperties:async e=>{const t=document.querySelector(e),r=null==t?void 0:t.getAttribute("src");if(!r||!t)return;const o=await(async e=>{try{return await fetch(e).then((e=>e.blob()))}catch{return}})(r),{type:s,size:n}=o||{};return{name:i(r),mimeType:s?l(s):"",resolution:a(t),size:n?c(n):"",src:r,alt:t.getAttribute("alt")||""}},toggleEditableVisibility:(e,t)=>{const r=document.querySelector(e);r&&(t?r.style.removeProperty("color"):r.style.color="rgba(0, 0, 0, 0)")},getRichTextColors:e=>{const t=document.querySelector(e),r=[];if("richtext"===t.getAttribute("itemtype"))for(const e of t.children){const t=window.getComputedStyle(e).color;r.push(t)}return r}};(async()=>{const r=(0,e.connectToParent)({methods:f}),o=await r.promise;t.routines.discoverFonts({editor:o}),t.routines.observeEditables({editor:o}),t.routines.observeFrame({editor:o}),t.routines.relayNavigation({editor:o}),t.routines.relayUserInputs()})();
//# sourceMappingURL=index.js.map
